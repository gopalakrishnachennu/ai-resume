(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&l(s)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();const r="https://ai-resume-git-feature-9d1c2b-gopalakrishnachennu-5461s-projects.vercel.app",h=document.getElementById("not-connected"),x=document.getElementById("connected"),d=document.getElementById("connect-btn"),c=document.getElementById("fill-btn"),u=document.getElementById("refresh-btn"),m=document.getElementById("settings-btn"),f=document.getElementById("dashboard-btn"),I=document.getElementById("user-name"),L=document.getElementById("user-email"),b=document.getElementById("user-avatar"),v=document.getElementById("avatar-letter"),C=document.getElementById("stat-filled");document.getElementById("stat-accuracy");const E=document.getElementById("stat-apps");async function F(){console.log("[Popup] Initializing..."),await P(),N()}async function P(){var o,e;try{const t=await chrome.storage.local.get(["auth","profile","session","stats"]);if(console.log("[Popup] Storage data:",t),t.auth&&t.auth.uid)y(t.auth,t.profile,t.session,t.stats);else if(t.session){const l={displayName:((o=t.session.personalInfo)==null?void 0:o.name)||t.session.displayName||"User",email:((e=t.session.personalInfo)==null?void 0:e.email)||t.session.email||""};y(l,t.profile||t.session,t.session,t.stats)}else g()}catch(t){console.error("[Popup] Check connection failed:",t),g()}}function y(o,e,t,l){var s,i;h.style.display="none",x.style.display="flex";const n=o.displayName||((s=t==null?void 0:t.personalInfo)==null?void 0:s.name)||"User",a=o.email||((i=t==null?void 0:t.personalInfo)==null?void 0:i.email)||"";I.textContent=n,L.textContent=a,o.photoURL?b.innerHTML=`<img src="${o.photoURL}" alt="${n}">`:v.textContent=n[0].toUpperCase(),l&&(C.textContent=l.filledToday||0,E.textContent=l.totalApplications||l.totalFilled||0),e&&console.log("[Popup] Profile loaded:",{identity:e.identity,hasAuth:!!e.authorization,hasSalary:!!e.salary,hasExp:!!e.experience}),t&&console.log("[Popup] Session loaded:",{hasPersonalInfo:!!t.personalInfo,hasSkills:!!t.skills,hasExperience:!!t.experience})}function g(){h.style.display="flex",x.style.display="none"}function N(){d==null||d.addEventListener("click",()=>{chrome.tabs.create({url:r+"/settings/extension"})}),c==null||c.addEventListener("click",S),u==null||u.addEventListener("click",()=>{chrome.tabs.create({url:r+"/settings/extension"})}),m==null||m.addEventListener("click",()=>{chrome.tabs.create({url:r+"/settings/extension"})}),f==null||f.addEventListener("click",()=>{chrome.tabs.create({url:r+"/dashboard"})})}async function S(){const o=c.querySelector(".btn-title"),e=c.querySelector(".btn-icon"),t=o.textContent,l=e.textContent;c.classList.add("loading"),o.textContent="Filling...",e.textContent="â†»";try{const a=await chrome.storage.local.get(["profile","session"]);if(console.log("[Popup] Fill with data:",a),!a.profile&&!a.session){p("No profile data. Please sync from dashboard first."),n();return}const[s]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!(s!=null&&s.id)){p("No active tab found"),n();return}chrome.tabs.sendMessage(s.id,{type:"FILL_FORM"},i=>{if(c.classList.remove("loading"),chrome.runtime.lastError){o.textContent="Navigate to a job page first",e.textContent="ðŸ“‹",setTimeout(()=>{o.textContent=t,e.textContent=l},2e3);return}i!=null&&i.success?(c.classList.add("success"),o.textContent="Filled "+(i.filled||0)+" Fields",e.textContent="âœ“",w(i.filled||0),setTimeout(()=>{c.classList.remove("success"),o.textContent=t,e.textContent=l},3e3)):(o.textContent=(i==null?void 0:i.error)||"No forms found",e.textContent="âš ",setTimeout(()=>{o.textContent=t,e.textContent=l},2500))})}catch(a){console.error("[Popup] Fill error:",a),n(),p("Unable to fill form")}function n(){c.classList.remove("loading"),o.textContent=t,e.textContent=l}}async function w(o){try{const t=(await chrome.storage.local.get(["stats"])).stats||{filledToday:0,totalApplications:0,totalFilled:0};t.filledToday=(t.filledToday||0)+o,t.totalFilled=(t.totalFilled||0)+o,await chrome.storage.local.set({stats:t}),C.textContent=t.filledToday,E.textContent=t.totalFilled}catch(e){console.error("[Popup] Update stats failed:",e)}}function p(o){console.log("[JobFiller] "+o)}document.addEventListener("DOMContentLoaded",F);
